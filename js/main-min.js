window.onload=function(){function e(){u=$("body").width(),h=$("body").height(),windowAspectRatio=u/h,desiredAspectRatio=16/9,v=u>800,c(),canvas.width=u,canvas.height=h}function i(e,i,a,o){a.hasClass("paused")&&(o.play(),a.removeClass("paused").addClass("playing"),i.removeClass("play").addClass("pause"),a.parent().addClass("child-playing"),$(".sidebar").removeClass("half-width").addClass("full-width")),o.addEventListener("timeupdate",function(){t(),o.currentTime>=o.duration&&(s(e,i,a,o),o.currentTime=0,scrubberBar.value=0)})}function s(e,i,s,t){s.hasClass("playing")&&(t.pause(),s.removeClass("playing").addClass("paused"),i.removeClass("pause").addClass("play"),$(".sidebar").removeClass("full-width").addClass("half-width"))}function t(){var e=thisVideoObject.currentTime/thisVideoObject.duration*100;$(scrubberBar).children("span").css("left",e+"%")}function a(e,i,s,t){}function o(){$(".video-controls").removeClass("invisible").addClass("visible"),$(".video-details").removeClass("invisible").addClass("visible"),m=!0}function d(){$(".video-controls").addClass("invisible").removeClass("visible"),$(".video-details").addClass("invisible").removeClass("visible"),m=!1}function l(){windowAspectRatio>desiredAspectRatio?(newHeight=u/desiredAspectRatio,verticalCenter=-(newHeight-h)/2,p.drawImage(vid,0,verticalCenter,u,newHeight)):windowAspectRatio<desiredAspectRatio&&(newWidth=h*desiredAspectRatio,horiztonalCenter=-(newWidth-u)/2,p.drawImage(vid,horiztonalCenter,0,newWidth,h)),loopVideoTimer=setTimeout(l,10)}function r(e){canvas.className="hide-me",$("#cloud").removeClass("visible").addClass("hide-me"),e.pause(),e.currentTime=0,clearTimeout(loopVideoTimer),C=!1}function n(e){e.volume=0,e.currentTime=0,e.play(),canvas.className="visible",$("#cloud").removeClass("hide-me").addClass("visible"),C=!0,setTimeout(l,5),e.addEventListener("timeupdate",function(){e.currentTime>=e.duration&&r(e)});var i=setInterval(function(){!e.paused&&e.volume<.9?e.volume=e.volume+.05:(e.volume=1,clearInterval(i))},100)}function c(){function e(e){window.location.hash=e.get(0)}function t(e){var i=$(document).scrollTop();i<100?$(".scroll-hide").removeClass("invisible").addClass("visible"):i>100&&$(".scroll-hide").hasClass("visible")&&$(".scroll-hide").removeClass("visible").addClass("invisible")}1==v&&0==jsLoaded?(jsLoaded=!0,$(".video-controls").click(function(e){var t=$(this).data("id");playPause=$(this).children(".play-pause"),thisVideo=$("video[data-id='"+t+"']"),thisVideoObject=thisVideo.get(0),scrubberBar=$(this).children(".scrubber-bar").get(0),isPlaying=thisVideoObject.currentTime>0&&!thisVideoObject.paused&&!thisVideoObject.ended&&thisVideoObject.readyState>2,$(e.target).hasClass("play")&&!isPlaying?($(".playing").length&&($(".playing").get(0).pause(),$(".playing").removeClass("playing").addClass("paused"),$(".pause").removeClass("pause").addClass("play")),i(t,playPause,thisVideo,thisVideoObject)):$(e.target).hasClass("pause")&&isPlaying?s(t,playPause,thisVideo,thisVideoObject):$(e.target).hasClass("full-screen")?(thisVideoObject.requestFullscreen?thisVideoObject.requestFullscreen():thisVideoObject.mozRequestFullScreen?thisVideoObject.mozRequestFullScreen():thisVideoObject.webkitRequestFullscreen&&thisVideoObject.webkitRequestFullscreen(),i(t,playPause,thisVideo,thisVideoObject)):$(e.target).hasClass("scrubber-bar")&&(offset=$(scrubberBar).offset(),left=e.pageX-offset.left,totalWidth=$(scrubberBar).width(),percentage=left/totalWidth,videoTime=thisVideoObject.duration*percentage,thisVideoObject.currentTime=videoTime)}),$(".video-wrapper").mousemove(function(){clearTimeout(hoverTimer),o(),hoverTimer=setTimeout(function(){d()},1e3)}),vid.muted=!1,f.mousedown(function(){audio=document.createElement("audio"),audio.src=$(this).attr("data-audio"),audio.play(),vid.src=$(this).parent().parent().attr("data-overlay-vid"),vid.paused&&$("#canvas").hasClass("hide-me")&&!vid.currentTime>0&&!C&&n(vid)}),f.mouseup(function(){r(vid)}),$('a[href*="#"]').not('[href="#"]').not('[href="#0"]').click(function(e){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var i=$(this.hash);i=i.length?i:$("[name="+this.hash.slice(1)+"]"),i.length&&(e.preventDefault(),$(".active").removeClass("active"),$('a[href="#'+i.attr("id")+'"]').addClass("active"),$("html, body").animate({scrollTop:i.offset().top},1e3,function(){var e=$(i);if(e.focus(),e.is(":focus"))return!1;e.attr("tabindex","-1"),e.focus()}))}}),$(document).on("scroll",t)):1!=v&&0==jsLoaded&&$(".video-controls").click(function(e){var i=$(this).data("id");playPause=$(this).children(".play-pause"),thisVideo=$("video[data-id='"+i+"']"),thisVideoObject=thisVideo.get(0),scrubberBar=$(this).children(".scrubber-bar").get(0),isPlaying=thisVideoObject.currentTime>0&&!thisVideoObject.paused&&!thisVideoObject.ended&&thisVideoObject.readyState>2,thisVideoObject.play()})}var u,h,v,m=!1,b=document.getElementById("canvas"),p=b.getContext("2d"),f=$(".coordinates"),C=!1;audio=$("audio").get(0),hoverTimer=null,vid=document.createElement("video"),vid.setAttribute("id","overlay-video"),jsLoaded=!1,e(),window.sr=ScrollReveal(),sr.reveal(".scroll-reveal",{duration:500,distance:"50px",scale:1,easing:"cubic-bezier(0.39, 0.575, 0.565, 1)",delay:200,origin:"bottom"}),$("#loader").fadeOut(),$(window).resize(function(){e()})};var $form=$("form#submission-form"),url="https://script.google.com/a/kingspoke.co/macros/s/AKfycbyJiiht9by1aDJY-VRxGgjptIYK19LO8E_x0v4noQaFYE1yo2g/exec";$("#submit-form").on("click",function(e){if(console.log("clicked"),e.preventDefault(),$("textarea").val())var i=$.ajax({url:url,method:"GET",dataType:"json",data:$form.serializeObject(),success:function(e){Success=!0,$("#submit-form").html("Thanks."),$("textarea").css({opacity:.25})},error:function(e,i){Success=!1}});else $(".error").removeClass("hide").addClass("show"),setTimeout(function(){$(".error").removeClass("show").addClass("hide")},2e3)});